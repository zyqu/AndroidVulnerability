#!/usr/bin/python

import os
import json 
class FileParseUrl: 

	def __init__(self,path):
		self.path=path

	def GetUrl(self,path):
		list_dirs = os.walk(path) 
		for root, dirs, files in list_dirs: 
   
			for f in files:
				lisyhttp=[]
				lisyhttps=[] 
				filepath=os.path.join(root, f)
				#print filepath
				if filepath.find(".smali")>=0 or filepath.find(".properties")>=0:
				#if filepath.find("AndroidManifest.xml")<0:
					file_object=open(filepath)
					try:
						list_of_all_the_lines = file_object.readlines()
						for line in list_of_all_the_lines:
							templine=line.lower()
							if templine.find("http://")>0: 
								templine = templine[templine.find("http://") :]
								if templine.find("\"")>0:
									templine = templine[:templine.find("\"")]
								if templine[len(templine)-1]=="\r" or templine[len(templine)-1]=="\n":
									templine=templine[:len(templine)-1]
								if templine[len(templine)-1]=="\\":
									templine=templine[:len(templine)-1]
								if templine.find ('schemas.android.com')<0:								
									lisyhttp.append(templine)
							if templine.find("https://")>0:
								templine = templine[templine.find("https://") :]
								if templine.find("\"")>0:
									templine = templine[:templine.find("\"")]
								if templine[len(templine)-1]=="\r" or templine[len(templine)-1]=="\n":
									templine=templine[:len(templine)-1]
								if templine[len(templine)-1]=="\\":
									templine=templine[:len(templine)-1]
								if templine.find('schemas.android.com')<0:
									lisyhttps.append(templine)
						if len(lisyhttp)>0 or len(lisyhttps)>0:
							print filepath
						if len(lisyhttp)>0:
							print ("http",lisyhttp)	
						if len(lisyhttps)>0:
							print ("https",lisyhttps)
						
						#print "\n"	
					finally:
						
						file_object.close()
	
	

if __name__=="__main__":
	fileparseurl=FileParseUrl("")
	fileparseurl.GetUrl("/home/zyqu/Research/Android_sec/aib.ibank.android")


